<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NoMoreFap Ultra</title>

  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#22c55e"/>

  <link rel="stylesheet" href="style.css">
</head>

<body>
  <div class="glow"></div>

  <div class="app">

    <div class="top">
      <div class="brand">
        <div class="brandLeft">
          <div class="logo">âš¡</div>
          <div class="titleWrap">
            <h1>NoMoreFap Ultra</h1>
            <p>Streak â€¢ Calendar â€¢ Stats â€¢ Lock</p>
          </div>
        </div>
        <button class="toggleBtn" onclick="toggleTheme()">ğŸŒ“</button>
      </div>

      <div class="tabs">
        <div class="tab active" id="tabHome" onclick="switchTab('home')">Home</div>
        <div class="tab" id="tabStats" onclick="switchTab('stats')">Stats</div>
        <div class="tab" id="tabSettings" onclick="switchTab('settings')">Settings</div>
      </div>

      <div class="quoteBox">
        <div class="q" id="quoteText">Loading motivation...</div>
        <div class="by" id="quoteBy"></div>
      </div>

      <div class="btnRow">
        <button class="btnPrimary" onclick="markCleanDay()">âœ… Mark Clean Day</button>
        <button class="btnDanger" onclick="openResetFlow()">ğŸ”’ Reset</button>
      </div>

      <div class="btnRow">
        <button class="btnGhost" onclick="newQuote()">âœ¨ New Quote</button>
        <button class="btnBlue" onclick="quickLock()">ğŸ§Š Quick Lock</button>
      </div>

      <div class="grid">
        <div class="card">
          <h2>Current Streak</h2>
          <div class="big"><span id="streak">0</span> ğŸ”¥</div>
          <div class="mini">Best: <span id="best">0</span> days</div>
        </div>

        <div class="card">
          <h2>Goal Progress</h2>
          <div class="big"><span id="goal">30</span> ğŸ¯</div>
          <div class="mini">Target days</div>
          <div class="progressWrap"><div class="bar" id="bar"></div></div>
          <div class="mini" style="margin-top:8px;"><span id="percent">0</span>% complete</div>
        </div>
      </div>
    </div>

    <div id="pageHome">
      <div class="section">
        <div class="sectionTitle">ğŸ—“ Daily Streak Calendar</div>
        <div class="mini" id="calTitle" style="margin-bottom:10px;"></div>
        <div class="calendar" id="calendar"></div>
        <div class="mini" style="margin-top:10px;">Green = Clean âœ… | Red = Relapse ğŸ”´</div>
      </div>

      <div class="section">
        <div class="sectionTitle">ğŸ§  Daily Mood Check</div>
        <select id="mood">
          <option value="">Select mood</option>
          <option>Happy ğŸ˜Š</option>
          <option>Normal ğŸ˜</option>
          <option>Stressed ğŸ˜£</option>
          <option>Urge High ğŸ”¥</option>
          <option>Sad ğŸ˜”</option>
          <option>Focused ğŸ’ª</option>
        </select>

        <div style="height:10px;"></div>
        <textarea id="note" placeholder="Write your notes..."></textarea>

        <div class="btnRow" style="margin-top:10px;">
          <button class="btnPrimary" onclick="saveDailyLog()">ğŸ’¾ Save Log</button>
          <button class="btnGhost" onclick="clearLog()">ğŸ§¹ Clear</button>
        </div>
      </div>

      <div class="section">
        <div class="sectionTitle">ğŸ“œ Relapse History Logs</div>
        <div class="mini">Every reset will be saved here with date & mood.</div>
        <div class="history" id="historyList"></div>

        <div class="smallBtns">
          <button class="btnGhost" onclick="clearHistory()">ğŸ§¹ Clear History</button>
          <button class="btnGhost" onclick="downloadBackup()">â¬‡ Export</button>
        </div>

        <div style="height:10px;"></div>
        <input type="file" id="importFile" accept=".json" />
        <div class="btnRow" style="margin-top:10px;">
          <button class="btnBlue" onclick="importBackup()">ğŸ“¥ Import Backup</button>
          <button class="btnGhost" onclick="factoryReset()">âš  Factory Reset</button>
        </div>
      </div>
    </div>

    <div id="pageStats" class="hide">
      <div class="section">
        <div class="sectionTitle">ğŸ“Š Statistics</div>
        <div class="mini">Weekly clean days (last 7 days)</div>
        <div class="chart" id="weeklyChart"></div>

        <div class="statsGrid">
          <div class="card">
            <h2>Total Clean Days</h2>
            <div class="big"><span id="totalClean">0</span> âœ…</div>
          </div>
          <div class="card">
            <h2>Total Relapses</h2>
            <div class="big"><span id="totalRelapse">0</span> ğŸ”´</div>
          </div>
        </div>

        <div class="statsGrid" style="margin-top:12px;">
          <div class="card">
            <h2>Success Rate</h2>
            <div class="big"><span id="successRate">0</span>%</div>
          </div>
          <div class="card">
            <h2>Goal</h2>
            <div class="big"><span id="goalShow">30</span> ğŸ¯</div>
          </div>
        </div>
      </div>
    </div>

    <div id="pageSettings" class="hide">
      <div class="section">
        <div class="sectionTitle">âš™ Settings</div>

        <div class="mini">Change goal (days)</div>
        <div style="height:8px;"></div>
        <input id="goalInput" type="number" placeholder="Example: 30" />

        <div class="btnRow" style="margin-top:10px;">
          <button class="btnPrimary" onclick="saveGoal()">âœ… Save Goal</button>
          <button class="btnGhost" onclick="loadGoalToUI()">â†© Refresh</button>
        </div>

        <div style="height:14px;"></div>
        <div class="mini">Password Lock</div>
        <div style="height:8px;"></div>

        <input id="passInput" type="password" placeholder="Set password (min 4)" />
        <div class="btnRow" style="margin-top:10px;">
          <button class="btnBlue" onclick="setPassword()">ğŸ” Set Password</button>
          <button class="btnGhost" onclick="removePassword()">ğŸ—‘ Remove</button>
        </div>
      </div>
    </div>

    <div class="footer">
      Offline âœ… Export/Import âœ… Password Lock âœ…
    </div>
  </div>

  <div class="modalOverlay" id="modalOverlay">
    <div class="modal">
      <div class="modalTitle">ğŸ”’ Reset Lock Mode</div>
      <div class="modalText">Type OTP: <b>RELAPSE</b></div>

      <div class="otpRow" id="otpRow"></div>
      <div class="lockTimer" id="lockTimer">Wait: 07s</div>

      <div style="height:10px;"></div>
      <input id="resetPasswordField" type="password" placeholder="Password (if set)" />

      <div class="btnRow" style="margin-top:12px;">
        <button class="btnGhost" onclick="closeModal()">Cancel</button>
        <button class="btnDanger" id="confirmResetBtn" onclick="confirmReset()" disabled>Confirm Reset</button>
      </div>
    </div>
  </div>

  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("./service-worker.js");
    }
  </script>

  <script src="app.js"></script>
</body>
</html>
